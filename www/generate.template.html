<!doctype html>
<!--Copyright 2020 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.-->
<html>
  <head>
    <title>Client Certs - Generated</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
    <style>
li {{ line-height: 1.5em }}

#details a {{ color: #aaf; }}
code {{ background-color: #eee; }}

     {extra_css}
    </style>
  </head>
  <body>
    <h1>Client Certs - Generated</h1>
    <p>New certificate generated by <code>{cn}</code>.</p>
    <p>This one has the Common Name <code>{new_cn}</code>.</p>
    <p>Download links (good for one day):
      <ul>
	<li><a href="{crt_link}">For Chrome (and some other desktop browsers)</a>
	  <ul>
	    <li>To use, download the file here or on another computer you want to log in from, then click it in the downloaded files bar at the bottom of the page. It should open <code>chrome://settings/certificates</code> (you should visit that page if it doesn't).</li>
	    <li>There, under the "Your certifcates" tab, click the Import button, and select the file you just downloaded, probably called <code>user.crt</code>. Enter the passphrase you entered one on the starting page, or just hit Enter if you didn't put one in.</li>
	    <li>You're done! Pages from this server which require client cert authentication may pop up a dialog asking which cert to use. Ordinarily, this one is the only one you will see, identified by <code>{new_cn}</code>, so you can simply click OK.</li>
	  </ul>
	</li>
	<li><a href="{pfx_link}">For Firefox</a>
	  <ul>
	    <li>To use, download the file here or on another computer you want to log in from. It should be named <code>user.pfx</code></li>
	    <li>Visit <code>about:preferences#privacy</code> and click the "View Certificates..." button under Security.</li>
	    <li>In the window that comes up, click the "Your Certificates" tab.</li>
	    <li>Click the Import button, and select the file you downloaded (<code>user.pfx</code>)</li>
	    <li>You're done! Pages from this server which require client cert authentication may pop up a dialog asking which cert to use. Ordinarily, this one is the only one you will see, identified by <code>{new_cn}</code>, so you can simply click OK.</li>
	  </ul>
	</li>
	<li><a href="{pfx_link}">For Android</a>
	  <ul>
	    <li>To use, download on the device you want to log in from. A dialog should appear with the title "Name the certificate", and a default name which is a very long string of letters and numbers. Replace it with something memorable, such as <code>{new_cn}</code>. Leave "Credential use" on "VPN and apps", and tap OK.</li>
	    <li>If the dialog did not come up, navigate to your Downloads folder in your device, and tap on the file, which should be named <code>user.pfx</code>. You should be given the option to open it in "Certificate Installer". Select that, and then follow the instructions above for the "Name the certificate" dialog that appears.</li>
	    <li>You're done! Pages from this server which require client cert authentication may pop up a dialog asking which cert to use. Ordinarily, this one is the only one you will see, using the name you entered in the naming dialog, so you can simply click OK.</li>
	  </ul>
	</li>
      </ul>
      <div id="details"><a target="_blank" href="download-details.html">Technical details on what this difference means</a></div>
    </p>
    <p>You might want to send the cert securely to another computer with <a href="https://webwormhole.io">https://webwormhole.io</a></p>
    <p>Or, you can send this link to anyone, to include these instructions and explanations. <a href="{explain_link}">{explain_link}</a></p>
    <p>Note that you don't technically need to keep the file around after you've installed it, but you might want to copy it somewhere safe as a backup, as there is no other way to recover your account.</p>
    <p id="another"><a href="index.cgi">Generate another?</a></p>
  </body>
</html>
